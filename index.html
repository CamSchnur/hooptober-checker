<html>
    <title>Hooptober X Checker</title>



<body>
    <p>Input:</p>
    <form id="uploadForm">
        <input type="file" id="csvUpload" accept=".csv" />
        <br/>
        <br/>
        <input type="submit" value="Analyze" />
    </form>
    <p>Results:</p>
</body>

<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script>
    const uploadForm = document.getElementById("uploadForm");
    const csvList = document.getElementById("csvUpload");

    uploadForm.addEventListener("submit", function (e){
        e.preventDefault();
        const input = csvList.files[0];
        const reader = new FileReader();
        const outputCheck = function(name, passed, movieTitle="", movieUrl="")
        {

        }
        const validateList = function()
        {
            //check against the rules here: https://letterboxd.com/cinemonster/list/hooptober-x-hooptober-hooptober-let-satan/
            console.log("test");
            console.log("test2");
//There must be 31 films
//6 countries
//8 decades
//2 post apocalyptic or natural disaster related films
//1 film with Robert Englund
//1 something is underground film
//3 Satan/Devil centered films
//1 Amicus film.
//The worst Dracula film (by Letterboxd rating) that you haven't seen and can access.
//1 LGBTQ+ connected film
//5 Films from De Palma, Wes Craven, Ken Russell, Hitchcock and/or Moorhead & Benson.
//2 Peter Cushing films
//1 film based on a work of or invoking the name Bram Stoker
//1 film based on a Clive Barker story
//1 film that was released the year that you turned 10
//1 Mario Bava film.
//1 film with an 'x' in the title 
//And 1 Tobe Hooper Film (There must ALWAYS be a Hooper film)
//***FOR THOSE THAT LIKE TO DO EXTRA WORK: WATCH The Zodiac Killer and
// 10 Rillington Place. 
//Like last year, there is a third film: Shaky Shivers.
        }
        reader.onload = function(e)
        {   
            const originalText = e.target.result;
            //Add better header to the top of the CSV so d3 can more easily parse it.
            //List items are in a format like:  // 1,Cursed,2005,https://boxd.it/1XiY,"some description"
            const betterFormat = "Number,Title,Year,URL,Description\n" + originalText;
                    
            //Parse the data from CSV
            const csvListData = d3.csvParse(betterFormat);

            //Want to ignore several rows here, 
                //row 1 "Letterboxd list export v7",...
                //row 2 "Date", "Name",...
                //row 3 "2022-01-01", 
                //row 4 (blank)
                //row 5 (extra headers)
            //for now, just skip first 5 rows.
            const movieListParsed = csvListData.slice(5);
          
            for(var i = 0; i < movieListParsed.length; i++)
            {
                console.log(movieListParsed[i]);
                //document.write(movieListParsed[i]["Title"] + "<br>");
            }
            validateList();
        }
        reader.readAsText(input);

    });
    
   
</script>
</html>


